##### Other languages: [简体中文](/CHN/CHN-08-2-数据库-事务)

# Database - 概要

### はじめに

**drogon**にはデータベースにアクセスするエンジンが備わっており、データベースでの接続はノンブロッキングIOで行われます。つまり、下層から上層のどこにおいてもアプリケーションはノンブロッキングかつ非同期で効率的に動作し、drogonの高い平行性を確保できます。現在、drogonではPostgreSQLとMySQLに対応しています。データベースを利用する場合、対応する開発環境を最初に導入しておいてください。drogonは自動的にヘッダーファイルとライブラリを検知し、対応する部分をコンパイルします。開発環境の導入については[Database Environment](/ENG/ENG-02-Installation?id=database-environment)を参照してください。

軽量なアプリケーションのために、drogonはsqlite3もサポートしています。非同期インターフェースはスレッドプールによって実装されており、前述のデータベースと同様に使用することができます。

### DbClient

drogonのデータベースの基底クラスは`DbClient`です。（これは抽象クラスであり、具体的な型は構築するインターフェースによって異なります。）一般的なデータベースのインターフェースとは異なり、`DbClient`オブジェクトは1つのデータベースへのコネクションとは対応しません。実際には1つまたは複数のコネクションを含めることができるので、コネクションをプールしていると表現する方が正確です。

`DbClient`では同期および非同期なインターフェースを提供します。また、非同期インターフェースではブロッキングおよびノンブロッキングIOに対応しています。もちろん、drogonの非同期フレームワークと連携するのであれば非同期かつノンブロッキングな方式が推奨されます。

通常、非同期インターフェースが呼び出された際は`DbClient`は待機しているコネクションの中から1つ選んで関連するクエリを実行します。結果が帰ってきたら、`DbClient`はデータを処理し、呼び出し元が設定したコールバックの関数オブジェクトへ渡します。待機しているコネクションが無い場合、実行内容はいったんキャッシュされ、その後処理が完了したコネクションがキャッシュから取得して実行します。

For details on `DbClient`, see [DbClient](/ENG/ENG-08-1-Database-DbClient).

### Transaction

The transaction object can be generated by `DbClient` to support transaction operations. In addition to the extra `rollback()` interface, the transaction object is basically the same as `DbClient`. The transaction class is `Transaction`. For details of the `Transaction` class, see [Transaction](/ENG/ENG-08-2-Database-Transaction).

### ORM

Drogon also provides support for **ORM**. Users can use the drogon_ctl command to read the tables in the database and generate the corresponding model source code. Then, execute the database operations of these models through the `Mapper<MODEL>` class template. Mapper provides simple and convenient interfaces for standard database operations, allowing users to make the additions, deletions, and changes to the table without writing sql statements. For **ORM**, please refer to [ORM](/ENG/ENG-08-3-Database-ORM)

# Next: [DbClient](/ENG/ENG-08-1-Database-DbClient)
